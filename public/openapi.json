{
  "openapi": "3.0.0",
  "info": {
    "title": "WxPusher API",
    "version": "1.0.0",
    "description": "Webhook 消息推送服务 API - 支持微信公众号、钉钉、企业微信等多渠道消息推送"
  },
  "servers": [
    {
      "url": "/v1",
      "description": "API v1"
    }
  ],
  "tags": [
    {
      "name": "System",
      "description": "系统接口"
    },
    {
      "name": "Channels",
      "description": "渠道管理"
    },
    {
      "name": "Apps",
      "description": "应用管理"
    },
    {
      "name": "OpenIDs",
      "description": "订阅者管理"
    },
    {
      "name": "Messages",
      "description": "消息管理"
    }
  ],
  "paths": {
    "/health": {
      "get": {
        "summary": "健康检查",
        "tags": [
          "System"
        ],
        "responses": {
          "200": {
            "description": "服务正常",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "object",
                      "required": [
                        "status",
                        "timestamp",
                        "runtime"
                      ],
                      "properties": {
                        "status": {
                          "description": "服务状态",
                          "type": "string"
                        },
                        "timestamp": {
                          "format": "date-time",
                          "description": "时间戳",
                          "type": "string"
                        },
                        "runtime": {
                          "description": "运行时信息",
                          "type": "string"
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "健康检查响应"
                }
              }
            }
          }
        }
      }
    },
    "/init/status": {
      "get": {
        "summary": "获取初始化状态",
        "tags": [
          "System"
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "object",
                      "required": [
                        "initialized",
                        "hasAdminToken"
                      ],
                      "properties": {
                        "initialized": {
                          "description": "是否已初始化",
                          "type": "boolean"
                        },
                        "hasAdminToken": {
                          "description": "是否已设置管理员 Token",
                          "type": "boolean"
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "初始化状态"
                }
              }
            }
          }
        }
      }
    },
    "/init": {
      "post": {
        "summary": "初始化系统",
        "tags": [
          "System"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "adminToken"
                ],
                "properties": {
                  "adminToken": {
                    "minLength": 8,
                    "description": "管理员 Token（至少 8 位）",
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "初始化成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "success": {
                          "type": "boolean"
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "初始化结果"
                }
              }
            }
          },
          "400": {
            "description": "参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": [
                    "code",
                    "message",
                    "data"
                  ],
                  "properties": {
                    "code": {
                      "description": "错误码",
                      "type": "integer"
                    },
                    "message": {
                      "description": "错误消息",
                      "type": "string"
                    },
                    "data": {
                      "type": "null"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/channels": {
      "get": {
        "summary": "获取渠道列表",
        "tags": [
          "Channels"
        ],
        "security": [
          {
            "AdminToken": []
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "id",
                          "name",
                          "type",
                          "config",
                          "createdAt",
                          "updatedAt"
                        ],
                        "properties": {
                          "id": {
                            "description": "渠道 ID",
                            "type": "string"
                          },
                          "name": {
                            "description": "渠道名称",
                            "type": "string"
                          },
                          "type": {
                            "description": "渠道类型",
                            "anyOf": [
                              {
                                "const": "wechat_mp",
                                "type": "string"
                              },
                              {
                                "const": "dingtalk",
                                "type": "string"
                              },
                              {
                                "const": "wecom",
                                "type": "string"
                              }
                            ]
                          },
                          "config": {
                            "description": "渠道配置（根据 type 不同结构不同）"
                          },
                          "createdAt": {
                            "format": "date-time",
                            "description": "创建时间",
                            "type": "string"
                          },
                          "updatedAt": {
                            "format": "date-time",
                            "description": "更新时间",
                            "type": "string"
                          }
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "渠道列表"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "创建渠道",
        "tags": [
          "Channels"
        ],
        "security": [
          {
            "AdminToken": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "type",
                  "config"
                ],
                "properties": {
                  "name": {
                    "description": "渠道名称",
                    "type": "string"
                  },
                  "type": {
                    "description": "渠道类型",
                    "anyOf": [
                      {
                        "const": "wechat_mp",
                        "type": "string"
                      },
                      {
                        "const": "dingtalk",
                        "type": "string"
                      },
                      {
                        "const": "wecom",
                        "type": "string"
                      }
                    ]
                  },
                  "config": {
                    "description": "渠道配置"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "object",
                      "required": [
                        "id",
                        "name",
                        "type",
                        "config",
                        "createdAt",
                        "updatedAt"
                      ],
                      "properties": {
                        "id": {
                          "description": "渠道 ID",
                          "type": "string"
                        },
                        "name": {
                          "description": "渠道名称",
                          "type": "string"
                        },
                        "type": {
                          "description": "渠道类型",
                          "anyOf": [
                            {
                              "const": "wechat_mp",
                              "type": "string"
                            },
                            {
                              "const": "dingtalk",
                              "type": "string"
                            },
                            {
                              "const": "wecom",
                              "type": "string"
                            }
                          ]
                        },
                        "config": {
                          "description": "渠道配置（根据 type 不同结构不同）"
                        },
                        "createdAt": {
                          "format": "date-time",
                          "description": "创建时间",
                          "type": "string"
                        },
                        "updatedAt": {
                          "format": "date-time",
                          "description": "更新时间",
                          "type": "string"
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "创建的渠道"
                }
              }
            }
          }
        }
      }
    },
    "/channels/{id}": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          },
          "description": "渠道 ID"
        }
      ],
      "get": {
        "summary": "获取渠道详情",
        "tags": [
          "Channels"
        ],
        "security": [
          {
            "AdminToken": []
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "object",
                      "required": [
                        "id",
                        "name",
                        "type",
                        "config",
                        "createdAt",
                        "updatedAt"
                      ],
                      "properties": {
                        "id": {
                          "description": "渠道 ID",
                          "type": "string"
                        },
                        "name": {
                          "description": "渠道名称",
                          "type": "string"
                        },
                        "type": {
                          "description": "渠道类型",
                          "anyOf": [
                            {
                              "const": "wechat_mp",
                              "type": "string"
                            },
                            {
                              "const": "dingtalk",
                              "type": "string"
                            },
                            {
                              "const": "wecom",
                              "type": "string"
                            }
                          ]
                        },
                        "config": {
                          "description": "渠道配置（根据 type 不同结构不同）"
                        },
                        "createdAt": {
                          "format": "date-time",
                          "description": "创建时间",
                          "type": "string"
                        },
                        "updatedAt": {
                          "format": "date-time",
                          "description": "更新时间",
                          "type": "string"
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "渠道详情"
                }
              }
            }
          },
          "404": {
            "description": "渠道不存在",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": [
                    "code",
                    "message",
                    "data"
                  ],
                  "properties": {
                    "code": {
                      "description": "错误码",
                      "type": "integer"
                    },
                    "message": {
                      "description": "错误消息",
                      "type": "string"
                    },
                    "data": {
                      "type": "null"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "更新渠道",
        "tags": [
          "Channels"
        ],
        "security": [
          {
            "AdminToken": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "description": "渠道名称",
                    "type": "string"
                  },
                  "config": {
                    "description": "渠道配置"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "object",
                      "required": [
                        "id",
                        "name",
                        "type",
                        "config",
                        "createdAt",
                        "updatedAt"
                      ],
                      "properties": {
                        "id": {
                          "description": "渠道 ID",
                          "type": "string"
                        },
                        "name": {
                          "description": "渠道名称",
                          "type": "string"
                        },
                        "type": {
                          "description": "渠道类型",
                          "anyOf": [
                            {
                              "const": "wechat_mp",
                              "type": "string"
                            },
                            {
                              "const": "dingtalk",
                              "type": "string"
                            },
                            {
                              "const": "wecom",
                              "type": "string"
                            }
                          ]
                        },
                        "config": {
                          "description": "渠道配置（根据 type 不同结构不同）"
                        },
                        "createdAt": {
                          "format": "date-time",
                          "description": "创建时间",
                          "type": "string"
                        },
                        "updatedAt": {
                          "format": "date-time",
                          "description": "更新时间",
                          "type": "string"
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "更新后的渠道"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "删除渠道",
        "tags": [
          "Channels"
        ],
        "security": [
          {
            "AdminToken": []
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功"
          }
        }
      }
    },
    "/apps": {
      "get": {
        "summary": "获取应用列表",
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "AdminToken": []
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "id",
                          "name",
                          "channelId",
                          "pushKey",
                          "createdAt",
                          "updatedAt"
                        ],
                        "properties": {
                          "id": {
                            "description": "应用 ID",
                            "type": "string"
                          },
                          "name": {
                            "description": "应用名称",
                            "type": "string"
                          },
                          "channelId": {
                            "description": "关联渠道 ID",
                            "type": "string"
                          },
                          "pushKey": {
                            "description": "推送密钥",
                            "type": "string"
                          },
                          "createdAt": {
                            "format": "date-time",
                            "description": "创建时间",
                            "type": "string"
                          },
                          "updatedAt": {
                            "format": "date-time",
                            "description": "更新时间",
                            "type": "string"
                          }
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "应用列表"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "创建应用",
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "AdminToken": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "channelId"
                ],
                "properties": {
                  "name": {
                    "description": "应用名称",
                    "type": "string"
                  },
                  "channelId": {
                    "description": "关联渠道 ID",
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "object",
                      "required": [
                        "id",
                        "name",
                        "channelId",
                        "pushKey",
                        "createdAt",
                        "updatedAt"
                      ],
                      "properties": {
                        "id": {
                          "description": "应用 ID",
                          "type": "string"
                        },
                        "name": {
                          "description": "应用名称",
                          "type": "string"
                        },
                        "channelId": {
                          "description": "关联渠道 ID",
                          "type": "string"
                        },
                        "pushKey": {
                          "description": "推送密钥",
                          "type": "string"
                        },
                        "createdAt": {
                          "format": "date-time",
                          "description": "创建时间",
                          "type": "string"
                        },
                        "updatedAt": {
                          "format": "date-time",
                          "description": "更新时间",
                          "type": "string"
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "创建的应用"
                }
              }
            }
          }
        }
      }
    },
    "/apps/{appId}": {
      "parameters": [
        {
          "name": "appId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          },
          "description": "应用 ID"
        }
      ],
      "get": {
        "summary": "获取应用详情",
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "AdminToken": []
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "object",
                      "required": [
                        "id",
                        "name",
                        "channelId",
                        "pushKey",
                        "createdAt",
                        "updatedAt"
                      ],
                      "properties": {
                        "id": {
                          "description": "应用 ID",
                          "type": "string"
                        },
                        "name": {
                          "description": "应用名称",
                          "type": "string"
                        },
                        "channelId": {
                          "description": "关联渠道 ID",
                          "type": "string"
                        },
                        "pushKey": {
                          "description": "推送密钥",
                          "type": "string"
                        },
                        "createdAt": {
                          "format": "date-time",
                          "description": "创建时间",
                          "type": "string"
                        },
                        "updatedAt": {
                          "format": "date-time",
                          "description": "更新时间",
                          "type": "string"
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "应用详情"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "更新应用",
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "AdminToken": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "description": "应用名称",
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "object",
                      "required": [
                        "id",
                        "name",
                        "channelId",
                        "pushKey",
                        "createdAt",
                        "updatedAt"
                      ],
                      "properties": {
                        "id": {
                          "description": "应用 ID",
                          "type": "string"
                        },
                        "name": {
                          "description": "应用名称",
                          "type": "string"
                        },
                        "channelId": {
                          "description": "关联渠道 ID",
                          "type": "string"
                        },
                        "pushKey": {
                          "description": "推送密钥",
                          "type": "string"
                        },
                        "createdAt": {
                          "format": "date-time",
                          "description": "创建时间",
                          "type": "string"
                        },
                        "updatedAt": {
                          "format": "date-time",
                          "description": "更新时间",
                          "type": "string"
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "更新后的应用"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "删除应用",
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "AdminToken": []
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功"
          }
        }
      }
    },
    "/apps/{appId}/qrcode": {
      "parameters": [
        {
          "name": "appId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          },
          "description": "应用 ID"
        }
      ],
      "get": {
        "summary": "获取应用订阅二维码",
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "AdminToken": []
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "qrcodeUrl": {
                          "type": "string",
                          "description": "二维码图片 URL"
                        },
                        "expireAt": {
                          "type": "string",
                          "format": "date-time",
                          "description": "过期时间"
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "二维码信息"
                }
              }
            }
          }
        }
      }
    },
    "/apps/{appId}/openids": {
      "parameters": [
        {
          "name": "appId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          },
          "description": "应用 ID"
        }
      ],
      "get": {
        "summary": "获取应用的订阅者列表",
        "tags": [
          "OpenIDs"
        ],
        "security": [
          {
            "AdminToken": []
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "id",
                          "appId",
                          "openId",
                          "subscribed",
                          "createdAt",
                          "updatedAt"
                        ],
                        "properties": {
                          "id": {
                            "description": "OpenID 记录 ID",
                            "type": "string"
                          },
                          "appId": {
                            "description": "应用 ID",
                            "type": "string"
                          },
                          "openId": {
                            "description": "用户 OpenID",
                            "type": "string"
                          },
                          "nickname": {
                            "description": "用户昵称",
                            "type": "string"
                          },
                          "subscribed": {
                            "description": "是否已关注",
                            "type": "boolean"
                          },
                          "createdAt": {
                            "format": "date-time",
                            "description": "创建时间",
                            "type": "string"
                          },
                          "updatedAt": {
                            "format": "date-time",
                            "description": "更新时间",
                            "type": "string"
                          }
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "订阅者列表"
                }
              }
            }
          }
        }
      }
    },
    "/messages": {
      "get": {
        "summary": "获取消息列表",
        "tags": [
          "Messages"
        ],
        "security": [
          {
            "AdminToken": []
          }
        ],
        "parameters": [
          {
            "name": "appId",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "按应用 ID 筛选"
          },
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 20
            },
            "description": "返回数量"
          },
          {
            "name": "offset",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 0
            },
            "description": "偏移量"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "description": "错误码，0 表示成功"
                    },
                    "message": {
                      "type": "string",
                      "description": "消息"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "id",
                          "appId",
                          "openId",
                          "content",
                          "status",
                          "createdAt"
                        ],
                        "properties": {
                          "id": {
                            "description": "消息 ID",
                            "type": "string"
                          },
                          "appId": {
                            "description": "应用 ID",
                            "type": "string"
                          },
                          "openId": {
                            "description": "接收者 OpenID",
                            "type": "string"
                          },
                          "content": {
                            "description": "消息内容",
                            "type": "string"
                          },
                          "status": {
                            "description": "发送状态",
                            "anyOf": [
                              {
                                "const": "pending",
                                "type": "string"
                              },
                              {
                                "const": "sent",
                                "type": "string"
                              },
                              {
                                "const": "failed",
                                "type": "string"
                              }
                            ]
                          },
                          "createdAt": {
                            "format": "date-time",
                            "description": "创建时间",
                            "type": "string"
                          }
                        }
                      }
                    }
                  },
                  "required": [
                    "code",
                    "data"
                  ],
                  "description": "消息列表"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Channel": {
        "type": "object",
        "required": [
          "id",
          "name",
          "type",
          "config",
          "createdAt",
          "updatedAt"
        ],
        "properties": {
          "id": {
            "description": "渠道 ID",
            "type": "string"
          },
          "name": {
            "description": "渠道名称",
            "type": "string"
          },
          "type": {
            "description": "渠道类型",
            "anyOf": [
              {
                "const": "wechat_mp",
                "type": "string"
              },
              {
                "const": "dingtalk",
                "type": "string"
              },
              {
                "const": "wecom",
                "type": "string"
              }
            ]
          },
          "config": {
            "description": "渠道配置（根据 type 不同结构不同）"
          },
          "createdAt": {
            "format": "date-time",
            "description": "创建时间",
            "type": "string"
          },
          "updatedAt": {
            "format": "date-time",
            "description": "更新时间",
            "type": "string"
          }
        }
      },
      "App": {
        "type": "object",
        "required": [
          "id",
          "name",
          "channelId",
          "pushKey",
          "createdAt",
          "updatedAt"
        ],
        "properties": {
          "id": {
            "description": "应用 ID",
            "type": "string"
          },
          "name": {
            "description": "应用名称",
            "type": "string"
          },
          "channelId": {
            "description": "关联渠道 ID",
            "type": "string"
          },
          "pushKey": {
            "description": "推送密钥",
            "type": "string"
          },
          "createdAt": {
            "format": "date-time",
            "description": "创建时间",
            "type": "string"
          },
          "updatedAt": {
            "format": "date-time",
            "description": "更新时间",
            "type": "string"
          }
        }
      },
      "OpenID": {
        "type": "object",
        "required": [
          "id",
          "appId",
          "openId",
          "subscribed",
          "createdAt",
          "updatedAt"
        ],
        "properties": {
          "id": {
            "description": "OpenID 记录 ID",
            "type": "string"
          },
          "appId": {
            "description": "应用 ID",
            "type": "string"
          },
          "openId": {
            "description": "用户 OpenID",
            "type": "string"
          },
          "nickname": {
            "description": "用户昵称",
            "type": "string"
          },
          "subscribed": {
            "description": "是否已关注",
            "type": "boolean"
          },
          "createdAt": {
            "format": "date-time",
            "description": "创建时间",
            "type": "string"
          },
          "updatedAt": {
            "format": "date-time",
            "description": "更新时间",
            "type": "string"
          }
        }
      },
      "Message": {
        "type": "object",
        "required": [
          "id",
          "appId",
          "openId",
          "content",
          "status",
          "createdAt"
        ],
        "properties": {
          "id": {
            "description": "消息 ID",
            "type": "string"
          },
          "appId": {
            "description": "应用 ID",
            "type": "string"
          },
          "openId": {
            "description": "接收者 OpenID",
            "type": "string"
          },
          "content": {
            "description": "消息内容",
            "type": "string"
          },
          "status": {
            "description": "发送状态",
            "anyOf": [
              {
                "const": "pending",
                "type": "string"
              },
              {
                "const": "sent",
                "type": "string"
              },
              {
                "const": "failed",
                "type": "string"
              }
            ]
          },
          "createdAt": {
            "format": "date-time",
            "description": "创建时间",
            "type": "string"
          }
        }
      },
      "CreateChannelInput": {
        "type": "object",
        "required": [
          "name",
          "type",
          "config"
        ],
        "properties": {
          "name": {
            "description": "渠道名称",
            "type": "string"
          },
          "type": {
            "description": "渠道类型",
            "anyOf": [
              {
                "const": "wechat_mp",
                "type": "string"
              },
              {
                "const": "dingtalk",
                "type": "string"
              },
              {
                "const": "wecom",
                "type": "string"
              }
            ]
          },
          "config": {
            "description": "渠道配置"
          }
        }
      },
      "UpdateChannelInput": {
        "type": "object",
        "properties": {
          "name": {
            "description": "渠道名称",
            "type": "string"
          },
          "config": {
            "description": "渠道配置"
          }
        }
      },
      "CreateAppInput": {
        "type": "object",
        "required": [
          "name",
          "channelId"
        ],
        "properties": {
          "name": {
            "description": "应用名称",
            "type": "string"
          },
          "channelId": {
            "description": "关联渠道 ID",
            "type": "string"
          }
        }
      },
      "UpdateAppInput": {
        "type": "object",
        "properties": {
          "name": {
            "description": "应用名称",
            "type": "string"
          }
        }
      },
      "SendMessageInput": {
        "type": "object",
        "required": [
          "content"
        ],
        "properties": {
          "content": {
            "description": "消息内容",
            "type": "string"
          },
          "openIds": {
            "description": "指定接收者 OpenID 列表",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "sendToAll": {
            "description": "是否发送给所有订阅者",
            "default": false,
            "type": "boolean"
          }
        }
      },
      "InitInput": {
        "type": "object",
        "required": [
          "adminToken"
        ],
        "properties": {
          "adminToken": {
            "minLength": 8,
            "description": "管理员 Token（至少 8 位）",
            "type": "string"
          }
        }
      },
      "HealthResponse": {
        "type": "object",
        "required": [
          "status",
          "timestamp",
          "runtime"
        ],
        "properties": {
          "status": {
            "description": "服务状态",
            "type": "string"
          },
          "timestamp": {
            "format": "date-time",
            "description": "时间戳",
            "type": "string"
          },
          "runtime": {
            "description": "运行时信息",
            "type": "string"
          }
        }
      },
      "InitStatus": {
        "type": "object",
        "required": [
          "initialized",
          "hasAdminToken"
        ],
        "properties": {
          "initialized": {
            "description": "是否已初始化",
            "type": "boolean"
          },
          "hasAdminToken": {
            "description": "是否已设置管理员 Token",
            "type": "boolean"
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "required": [
          "code",
          "message",
          "data"
        ],
        "properties": {
          "code": {
            "description": "错误码",
            "type": "integer"
          },
          "message": {
            "description": "错误消息",
            "type": "string"
          },
          "data": {
            "type": "null"
          }
        }
      },
      "ChannelType": {
        "description": "渠道类型",
        "anyOf": [
          {
            "const": "wechat_mp",
            "type": "string"
          },
          {
            "const": "dingtalk",
            "type": "string"
          },
          {
            "const": "wecom",
            "type": "string"
          }
        ]
      },
      "WeChatMPConfig": {
        "type": "object",
        "required": [
          "appId",
          "appSecret",
          "token"
        ],
        "properties": {
          "appId": {
            "description": "微信公众号 AppID",
            "type": "string"
          },
          "appSecret": {
            "description": "微信公众号 AppSecret",
            "type": "string"
          },
          "token": {
            "description": "微信公众号 Token",
            "type": "string"
          },
          "encodingAESKey": {
            "description": "消息加解密密钥",
            "type": "string"
          }
        }
      },
      "MessageStatus": {
        "description": "发送状态",
        "anyOf": [
          {
            "const": "pending",
            "type": "string"
          },
          {
            "const": "sent",
            "type": "string"
          },
          {
            "const": "failed",
            "type": "string"
          }
        ]
      },
      "Pagination": {
        "type": "object",
        "required": [
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "total": {
            "description": "总数",
            "type": "integer"
          },
          "limit": {
            "description": "每页数量",
            "type": "integer"
          },
          "offset": {
            "description": "偏移量",
            "type": "integer"
          }
        }
      }
    },
    "securitySchemes": {
      "AdminToken": {
        "type": "apiKey",
        "in": "header",
        "name": "X-Admin-Token",
        "description": "管理员认证 Token"
      }
    }
  }
}